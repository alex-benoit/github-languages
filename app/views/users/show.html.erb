<div class="container">
  <div class="row">
    <div class="col-xs-12 col-md-10 col-md-offset-1 text-center">
      <h1>
        <%= @user["name"] ? @user["name"] : @user["login"] %>'s Languages
      </h1>
      <div class="row">
        <div class="col-xs-12 col-md-6">
          <table class="table-fill">
            <thead>
              <tr>
                <th class="text-left">Language</th>
                <!-- <th class="text-right">Storage</th> -->
                <th class="text-right">Lines</th>
                <th class="text-right">Percentage</th>
              </tr>
            </thead>
            <tbody class="table-hover">
              <% @sorted_languages.each do |lang_trio| %>
                <tr>
                  <td class="text-left"><%= lang_trio[0] %></td>
                  <!-- <td class="text-right"><%# "#{lang_trio[1]} B" %></td> -->
                  <td class="text-right"><%= "~#{lang_trio[1]/25} lines" %></td>
                  <td class="text-right"><%= "#{lang_trio[2].round(2)}%" %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <div class="col-xs-12 col-md-6">
          <div id="donut" style="width:400px; height:400px;"></div>
        </div>
      </div>
      <%= link_to "Back", root_path, class: "btn btn-default" %>
    </div>
  </div>
</div>

<%= content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {
      new Morris.Donut({
        element: 'donut',
        data: [
          <% @sorted_languages.each do |lang_trio| %>
            { label: '<%= lang_trio[0] %>', value: <%= (lang_trio[2]*10).ceil/10.0 %> },
          <% end %>
        ],
        formatter: function (y, data) { return y+'%' },
        colors: ["#5A869F", "#3E95B1", "#5D9475", "#ACA940", "#BAB037", "#B79649", "#BA8058", "#BF6775", "#B65171", "#8E5C79", "#776B81"]
      });
    });
  <% end %>
<% end %>
